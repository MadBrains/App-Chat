# AppChat
![Java 17](https://img.shields.io/badge/Java-17-brightgreen)
![Spring Boot](https://img.shields.io/badge/Spring_Boot-brightgreen)
![License](https://img.shields.io/badge/License-GPLv3-blue)

---

–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –∏ –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–æ–≤, –≥–∏–±–∫–æ–π —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏, –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ WebSocket-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏.

---

## üìå –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

AppChat –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –≤–Ω—É—Ç—Ä–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ä–æ–ª–∏, –ø—Ä–∞–≤–∞, –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è, –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏ —Ä–∞–±–æ—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ WebSocket.

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Java 17, Spring Boot
- Spring Security (JWT)
- STOMP/WebSocket + SockJS
- Liquibase
- JPA (Hibernate)
- PostgreSQL
- OpenAPI (SpringDoc)
- Lombok, MapStruct
- Passay (–≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π)
- i18n (—Ä—É—Å—Å–∫–∏–π, –∞–Ω–≥–ª–∏–π—Å–∫–∏–π)
- SMTP Email (Gmail)

---

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Java 17
- PostgreSQL 14+
- Gradle 8+
- SMTP-—É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ü–æ—Ä—Ç—ã: `8080` (HTTP), `5432` (PostgreSQL)

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ü—Ä–∏–º–µ—Ä `.env`:
```env
SPRING_DATASOURCE_URL=jdbc:postgresql://localhost:5432/appchat
SPRING_DATASOURCE_USERNAME=admin
SPRING_DATASOURCE_PASSWORD=secret
SPRING_MAIL_USERNAME=youremail@gmail.com
SPRING_MAIL_PASSWORD=emailpassword
APP_JWT_SECRETKEY=your_secure_key
```

> ‚ö†Ô∏è –î–ª—è Gmail –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –≤–∫–ª—é—á–∏—Ç—å "–º–µ–Ω–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è" –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å App Password.

---

## üß© –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- REST API: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —Ä–æ–ª–∏, —á–∞—Ç—ã, —Å–æ–æ–±—â–µ–Ω–∏—è, –ø—Ä–∞–≤–∞
- WebSocket API: —Å–æ–æ–±—â–µ–Ω–∏—è, –ø–µ—á–∞—Ç—å, –ø—Ä–æ—á—Ç–µ–Ω–∏–µ, –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã
- –°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏
- –ñ—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π (`change_log`, `entity_info`)
- –†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å –∏ `ExtendedPermissionType`

---

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

- JWT + Refresh —Ç–æ–∫–µ–Ω—ã
- –§–∏–ª—å—Ç—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `CLIENT` –∏ `WORKER`
- –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## üí¨ –ß–∞—Ç—ã –∏ —Å–æ–æ–±—â–µ–Ω–∏—è

- –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –∏ –≥—Ä—É–ø–ø–æ–≤—ã–µ —á–∞—Ç—ã
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã —á–∞—Ç–æ–≤
- –¢–µ–º—ã, –∏–∫–æ–Ω–∫–∏, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ reply, read-status
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ WebSocket

---

## üóÇ –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

```
[User] ‚Üî [Role]       (ManyToMany)
[Role] ‚Üî [Permission] (ManyToMany)
[Chat] ‚Üí [ChatMember] ‚Üí [User] (ManyToMany —á–µ—Ä–µ–∑ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏—é)
[Chat] ‚Üí [Message]    (OneToMany)
```

---

## üîÑ Liquibase

- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: `db/changelog/db.changelog-master.yaml`
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏
- –ù–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: —Ä–æ–ª–∏, –ø—Ä–∞–≤–∞, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä

–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π:
```bash
./gradlew liquibaseUpdate
```

---

## üåê –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

- –Ø–∑—ã–∫–∏: —Ä—É—Å—Å–∫–∏–π, –∞–Ω–≥–ª–∏–π—Å–∫–∏–π
- –Ø–∑—ã–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–º `Accept-Language`
- –§–∞–π–ª—ã: `messages_ru.properties`, `messages_en.properties`

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞:
1. –î–æ–±–∞–≤–∏—Ç—å `messages_XX.properties` –≤ `resources/messages`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
./gradlew test
```

---

## üöÄ –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
./gradlew bootRun
```

–° –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
SPRING_DATASOURCE_URL=... SPRING_DATASOURCE_USERNAME=... \
SPRING_DATASOURCE_PASSWORD=... SPRING_MAIL_USERNAME=... \
SPRING_MAIL_PASSWORD=... APP_JWT_SECRETKEY=... \
./gradlew bootRun
```

---

## üß∞ –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

- Swagger UI: [http://localhost:8080/swagger-ui.html](http://localhost:8080/swagger-ui.html)
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
    - Email: `testtest@gmail.test`
    - –ü–∞—Ä–æ–ª—å: `password`

---

## üîå WebSocket

- Endpoint: `/ws-chat`
- –ó–∞–≥–æ–ª–æ–≤–æ–∫: `Authorization: Bearer <token>`
- –¢–æ–ø–∏–∫–∏:
    - `/topic/messages/{chatId}`
    - `/user/queue/typing`
    - `/socket/app`

–ü—Ä–∏–º–µ—Ä –ø–æ–¥–ø–∏—Å–∫–∏:
```javascript
stompClient.subscribe('/topic/messages/123', (message) => {
  console.log('New message:', JSON.parse(message.body));
});
```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

- Swagger UI: `http://localhost:8080/swagger-ui.html`
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ JWT
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞: `app-chat-api`

---

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

–î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –ø–æ–¥ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –ª–∏—Ü–µ–Ω–∑–∏–µ–π GNU GPLv3. –í—ã –º–æ–∂–µ—Ç–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—à–∏ –Ω–∞—Ä–∞–±–æ—Ç–∫–∏ –≤ —Å–≤–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö, –≤ —Ç.—á. –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö, –ø—Ä–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–º —É—Å–ª–æ–≤–∏–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∏—Ö –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞. –¢–∞–∫–∂–µ –º—ã –≥–æ—Ç–æ–≤—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤–∞—à–∏ Pull requests, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —á—Ç–æ–±—ã –Ω–∞—à –ø—Ä–æ–µ–∫—Ç —Ä–∞–∑–≤–∏–≤–∞–ª—Å—è —Å —É—á—ë—Ç–æ–º –≤–∞—à–∏—Ö –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π –∏ –¥–æ—Ä–∞–±–æ—Ç–æ–∫.